{"version":3,"names":["AnimatedFlatList","Animated","createAnimatedComponent","FlatList","DraggableFlatListInner","props","useRefs","cellDataRef","containerRef","flatlistRef","keyToIndexRef","propsRef","animationConfigRef","useAnimatedValues","activeCellOffset","activeCellSize","activeIndexAnim","containerSize","scrollOffset","scrollViewSize","spacerIndexAnim","horizontalAnim","placeholderOffset","touchTranslate","autoScrollDistance","panGestureState","isTouchActiveNative","viewableIndexMin","viewableIndexMax","disabled","reset","useStableCallback","value","setActiveKey","dragHitSlop","DEFAULT_PROPS","scrollEnabled","activationDistance","activationDistanceProp","evtCache","useRef","useState","activeKey","current","enableLayoutAnimationExperimental","layoutAnimationDisabled","setLayoutAnimationDisabled","keyExtractor","item","index","Error","dataRef","data","dataHasChanged","map","join","useEffect","setTimeout","useLayoutEffect","forEach","d","i","key","set","drag","get","cellData","measurements","offset","size","onDragBegin","undefined","onContainerLayout","layout","nativeEvent","width","height","horizontal","onListContentSizeChange","w","h","onContentSizeChange","onContainerTouchStart","onContainerTouchEnd","extraData","useMemo","renderItem","useCallback","onRelease","onDragEnd","from","to","newData","splice","onPlaceholderIndexChange","useAnimatedReaction","cur","prev","hasMoved","runOnJS","gestureDisabled","useSharedValue","panGesture","Gesture","Pan","onBegin","evt","state","onUpdate","dragMinimalOffset","absoluteX","absoluteY","translation","translationX","translationY","onEnd","_evt","springTo","withSpring","onTouchesDown","onTouchesUp","hitSlop","activeOffset","activeOffsetX","activeOffsetY","onScroll","onScrollOffsetChange","scrollHandler","useAnimatedScrollHandler","contentOffset","x","y","useAutoScroll","onViewableItemsChanged","info","viewableIndices","viewableItems","filter","isViewable","min","Math","max","containerStyle","renderPlaceholder","CellRendererComponent","simultaneousHandlers","DraggableFlatList","ref","MemoizedInner","typedMemo","React","forwardRef"],"sources":["DraggableFlatList.tsx"],"sourcesContent":["import React, {\n  useCallback,\n  useEffect,\n  useLayoutEffect,\n  useMemo,\n  useRef,\n  useState,\n} from \"react\";\nimport { ListRenderItem, FlatListProps, LayoutChangeEvent } from \"react-native\";\nimport {\n  FlatList,\n  Gesture,\n  GestureDetector,\n  PanGestureHandlerEventPayload,\n} from \"react-native-gesture-handler\";\nimport Animated, {\n  runOnJS,\n  useAnimatedReaction,\n  useAnimatedScrollHandler,\n  useSharedValue,\n  withSpring,\n} from \"react-native-reanimated\";\nimport CellRendererComponent from \"./CellRendererComponent\";\nimport { DEFAULT_PROPS, isWeb } from \"../constants\";\nimport PlaceholderItem from \"./PlaceholderItem\";\nimport RowItem from \"./RowItem\";\nimport { DraggableFlatListProps } from \"../types\";\nimport PropsProvider from \"../context/propsContext\";\nimport AnimatedValueProvider, {\n  useAnimatedValues,\n} from \"../context/animatedValueContext\";\nimport RefProvider, { useRefs } from \"../context/refContext\";\nimport DraggableFlatListProvider from \"../context/draggableFlatListContext\";\nimport { useAutoScroll } from \"../hooks/useAutoScroll\";\nimport { useStableCallback } from \"../hooks/useStableCallback\";\nimport ScrollOffsetListener from \"./ScrollOffsetListener\";\nimport { typedMemo } from \"../utils\";\nimport { GestureUpdateEvent } from \"react-native-gesture-handler\";\n\ntype RNGHFlatListProps<T> = Animated.AnimateProps<\n  FlatListProps<T> & {\n    ref: React.Ref<FlatList<T>>;\n    simultaneousHandlers?: React.Ref<any> | React.Ref<any>[];\n  }\n>;\n\ntype OnViewableItemsChangedCallback<T> = Exclude<\n  FlatListProps<T>[\"onViewableItemsChanged\"],\n  undefined | null\n>;\n\nconst AnimatedFlatList = (Animated.createAnimatedComponent(\n  FlatList\n) as unknown) as <T>(props: RNGHFlatListProps<T>) => React.ReactElement;\n\nfunction DraggableFlatListInner<T>(props: DraggableFlatListProps<T>) {\n  const {\n    cellDataRef,\n    containerRef,\n    flatlistRef,\n    keyToIndexRef,\n    propsRef,\n    animationConfigRef,\n  } = useRefs<T>();\n  const {\n    activeCellOffset,\n    activeCellSize,\n    activeIndexAnim,\n    containerSize,\n    scrollOffset,\n    scrollViewSize,\n    spacerIndexAnim,\n    horizontalAnim,\n    placeholderOffset,\n    touchTranslate,\n    autoScrollDistance,\n    panGestureState,\n    isTouchActiveNative,\n    viewableIndexMin,\n    viewableIndexMax,\n    disabled,\n  } = useAnimatedValues();\n\n  const reset = useStableCallback(() => {\n    activeIndexAnim.value = -1;\n    spacerIndexAnim.value = -1;\n    touchTranslate.value = 0;\n    activeCellSize.value = -1;\n    activeCellOffset.value = -1;\n    setActiveKey(null);\n  });\n\n  const {\n    dragHitSlop = DEFAULT_PROPS.dragHitSlop,\n    scrollEnabled = DEFAULT_PROPS.scrollEnabled,\n    activationDistance: activationDistanceProp = DEFAULT_PROPS.activationDistance,\n  } = props;\n\n  const evtCache = useRef<GestureUpdateEvent<PanGestureHandlerEventPayload> | null>(\n    null\n  );\n\n  let [activeKey, setActiveKey] = useState<string | null>(null);\n  const [layoutAnimationDisabled, setLayoutAnimationDisabled] = useState(\n    !propsRef.current.enableLayoutAnimationExperimental\n  );\n\n  const keyExtractor = useStableCallback((item: T, index: number) => {\n    if (!props.keyExtractor) {\n      throw new Error(\"You must provide a keyExtractor to DraggableFlatList\");\n    }\n    return props.keyExtractor(item, index);\n  });\n\n  const dataRef = useRef(props.data);\n  const dataHasChanged =\n    dataRef.current.map(keyExtractor).join(\"\") !==\n    props.data.map(keyExtractor).join(\"\");\n  dataRef.current = props.data;\n  if (dataHasChanged) {\n    // When data changes make sure `activeKey` is nulled out in the same render pass\n    activeKey = null;\n  }\n\n  useEffect(() => {\n    if (!propsRef.current.enableLayoutAnimationExperimental) return;\n    if (activeKey) {\n      setLayoutAnimationDisabled(true);\n    } else {\n      // setTimeout result of trial-and-error to determine how long to wait before\n      // re-enabling layout animations so that a drag reorder does not trigger it.\n      setTimeout(() => {\n        setLayoutAnimationDisabled(false);\n      }, 100);\n    }\n  }, [activeKey]);\n\n  useLayoutEffect(() => {\n    props.data.forEach((d, i) => {\n      const key = keyExtractor(d, i);\n      keyToIndexRef.current.set(key, i);\n    });\n  }, [props.data, keyExtractor, keyToIndexRef]);\n\n  const drag = useStableCallback((activeKey: string) => {\n    if (disabled.value) return;\n    const index = keyToIndexRef.current.get(activeKey);\n    const cellData = cellDataRef.current.get(activeKey);\n    if (cellData) {\n      activeCellOffset.value = cellData.measurements.offset;\n      activeCellSize.value = cellData.measurements.size;\n    }\n\n    const { onDragBegin } = propsRef.current;\n    if (index !== undefined) {\n      spacerIndexAnim.value = index;\n      activeIndexAnim.value = index;\n      setActiveKey(activeKey);\n      onDragBegin?.(index);\n    }\n  });\n\n  const onContainerLayout = ({\n    nativeEvent: { layout },\n  }: LayoutChangeEvent) => {\n    const { width, height } = layout;\n    containerSize.value = props.horizontal ? width : height;\n    props.onContainerLayout?.({ layout, containerRef });\n  };\n\n  const onListContentSizeChange = (w: number, h: number) => {\n    scrollViewSize.value = props.horizontal ? w : h;\n    props.onContentSizeChange?.(w, h);\n  };\n\n  const onContainerTouchStart = () => {\n    if (!disabled.value) {\n      isTouchActiveNative.value = true;\n    }\n    return false;\n  };\n\n  const onContainerTouchEnd = () => {\n    isTouchActiveNative.value = false;\n  };\n\n  const extraData = useMemo(\n    () => ({\n      activeKey,\n      extraData: props.extraData,\n    }),\n    [activeKey, props.extraData]\n  );\n\n  const renderItem: ListRenderItem<T> = useCallback(\n    ({ item, index }) => {\n      const key = keyExtractor(item, index);\n      if (index !== keyToIndexRef.current.get(key)) {\n        keyToIndexRef.current.set(key, index);\n      }\n\n      return (\n        <RowItem\n          item={item}\n          itemKey={key}\n          renderItem={props.renderItem}\n          drag={drag}\n          extraData={props.extraData}\n        />\n      );\n    },\n    [props.renderItem, props.extraData, drag, keyExtractor]\n  );\n\n  const onRelease = useStableCallback((index: number) => {\n    props.onRelease?.(index);\n  });\n\n  const onDragEnd = useStableCallback(\n    ({ from, to }: { from: number; to: number }) => {\n      const { onDragEnd, data } = props;\n\n      const newData = [...data];\n      if (from !== to) {\n        newData.splice(from, 1);\n        newData.splice(to, 0, data[from]);\n      }\n\n      onDragEnd?.({ from, to, data: newData });\n      reset();\n    }\n  );\n\n  const onPlaceholderIndexChange = useStableCallback((index: number) => {\n    props.onPlaceholderIndexChange?.(index);\n  });\n\n  // Handle case where user ends drag without moving their finger.\n  useAnimatedReaction(\n    () => {\n      return isTouchActiveNative.value;\n    },\n    (cur, prev) => {\n      if (cur !== prev && !cur) {\n        const hasMoved = !!touchTranslate.value;\n        if (!hasMoved && activeIndexAnim.value >= 0 && !disabled.value) {\n          runOnJS(onRelease)(activeIndexAnim.value);\n          runOnJS(onDragEnd)({\n            from: activeIndexAnim.value,\n            to: spacerIndexAnim.value,\n          });\n        }\n      }\n    },\n    [isTouchActiveNative, onDragEnd, onRelease]\n  );\n\n  useAnimatedReaction(\n    () => {\n      return spacerIndexAnim.value;\n    },\n    (cur, prev) => {\n      if (prev !== null && cur !== prev && cur >= 0 && prev >= 0) {\n        runOnJS(onPlaceholderIndexChange)(cur);\n      }\n    },\n    [spacerIndexAnim]\n  );\n\n  const gestureDisabled = useSharedValue(false);\n\n  const panGesture = Gesture.Pan()\n    .onBegin((evt) => {\n      gestureDisabled.value = disabled.value;\n      if (gestureDisabled.value) return;\n      panGestureState.value = evt.state;\n    })\n    .onUpdate((evt) => {\n      if (gestureDisabled.value) return;\n\n      if (props.dragMinimalOffset && props.dragMinimalOffset > 0) {\n        if (horizontalAnim.value) {\n          if (evt.absoluteX < props.dragMinimalOffset) return;\n        } else {\n          if (evt.absoluteY < props.dragMinimalOffset) return;\n        }\n      }\n\n      panGestureState.value = evt.state;\n      const translation = horizontalAnim.value\n        ? evt.translationX\n        : evt.translationY;\n      touchTranslate.value = translation;\n\n      evtCache.current = evt;\n    })\n    .onEnd((_evt) => {\n      if (gestureDisabled.value) return;\n      // Set touch val to current translate val\n      isTouchActiveNative.value = false;\n\n      const evt = evtCache.current ? evtCache.current : _evt;\n\n      const translation = horizontalAnim.value\n        ? evt.translationX\n        : evt.translationY;\n\n      touchTranslate.value = translation + autoScrollDistance.value;\n      panGestureState.value = evt.state;\n\n      // Only call onDragEnd if actually dragging a cell\n      if (activeIndexAnim.value === -1 || disabled.value) return;\n      disabled.value = true;\n      runOnJS(onRelease)(activeIndexAnim.value);\n      const springTo = placeholderOffset.value - activeCellOffset.value;\n      touchTranslate.value = withSpring(\n        springTo,\n        animationConfigRef.current,\n        () => {\n          runOnJS(onDragEnd)({\n            from: activeIndexAnim.value,\n            to: spacerIndexAnim.value,\n          });\n          disabled.value = false;\n        }\n      );\n    })\n    .onTouchesDown(() => {\n      runOnJS(onContainerTouchStart)();\n    })\n    .onTouchesUp(() => {\n      // Turning this into a worklet causes timing issues. We want it to run\n      // just after the finger lifts.\n      runOnJS(onContainerTouchEnd)();\n    });\n\n  if (dragHitSlop) panGesture.hitSlop(dragHitSlop);\n  if (activationDistanceProp) {\n    const activeOffset = [-activationDistanceProp, activationDistanceProp];\n    if (props.horizontal) {\n      panGesture.activeOffsetX(activeOffset);\n    } else {\n      panGesture.activeOffsetY(activeOffset);\n    }\n  }\n\n  const onScroll = useStableCallback((scrollOffset: number) => {\n    props.onScrollOffsetChange?.(scrollOffset);\n  });\n\n  const scrollHandler = useAnimatedScrollHandler(\n    {\n      onScroll: (evt) => {\n        scrollOffset.value = horizontalAnim.value\n          ? evt.contentOffset.x\n          : evt.contentOffset.y;\n        runOnJS(onScroll)(scrollOffset.value);\n      },\n    },\n    [horizontalAnim]\n  );\n\n  useAutoScroll();\n\n  const onViewableItemsChanged = useStableCallback<\n    OnViewableItemsChangedCallback<T>\n  >((info) => {\n    const viewableIndices = info.viewableItems\n      .filter((item) => item.isViewable)\n      .map((item) => item.index)\n      .filter((index): index is number => typeof index === \"number\");\n\n    const min = Math.min(...viewableIndices);\n    const max = Math.max(...viewableIndices);\n    viewableIndexMin.value = min;\n    viewableIndexMax.value = max;\n    props.onViewableItemsChanged?.(info);\n  });\n\n  return (\n    <DraggableFlatListProvider\n      activeKey={activeKey}\n      keyExtractor={keyExtractor}\n      horizontal={!!props.horizontal}\n      layoutAnimationDisabled={layoutAnimationDisabled}\n    >\n      <GestureDetector gesture={panGesture}>\n        <Animated.View\n          style={props.containerStyle}\n          ref={containerRef}\n          onLayout={onContainerLayout}\n        >\n          {props.renderPlaceholder && (\n            <PlaceholderItem renderPlaceholder={props.renderPlaceholder} />\n          )}\n          <AnimatedFlatList\n            {...props}\n            data={props.data}\n            onViewableItemsChanged={onViewableItemsChanged}\n            CellRendererComponent={CellRendererComponent}\n            ref={flatlistRef}\n            onContentSizeChange={onListContentSizeChange}\n            scrollEnabled={!activeKey && scrollEnabled}\n            renderItem={renderItem}\n            extraData={extraData}\n            keyExtractor={keyExtractor}\n            onScroll={scrollHandler}\n            scrollEventThrottle={16}\n            simultaneousHandlers={props.simultaneousHandlers}\n            removeClippedSubviews={false}\n          />\n          {!!props.onScrollOffsetChange && (\n            <ScrollOffsetListener\n              onScrollOffsetChange={props.onScrollOffsetChange}\n              scrollOffset={scrollOffset}\n            />\n          )}\n        </Animated.View>\n      </GestureDetector>\n    </DraggableFlatListProvider>\n  );\n}\n\nfunction DraggableFlatList<T>(\n  props: DraggableFlatListProps<T>,\n  ref?: React.ForwardedRef<FlatList<T>> | null\n) {\n  return (\n    <PropsProvider {...props}>\n      <AnimatedValueProvider>\n        <RefProvider flatListRef={ref}>\n          <MemoizedInner {...props} />\n        </RefProvider>\n      </AnimatedValueProvider>\n    </PropsProvider>\n  );\n}\n\nconst MemoizedInner = typedMemo(DraggableFlatListInner);\n\n// Generic forwarded ref type assertion taken from:\n// https://fettblog.eu/typescript-react-generic-forward-refs/#option-1%3A-type-assertion\nexport default React.forwardRef(DraggableFlatList) as <T>(\n  props: DraggableFlatListProps<T> & { ref?: React.ForwardedRef<FlatList<T>> }\n) => ReturnType<typeof DraggableFlatList>;\n"],"mappings":"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"}